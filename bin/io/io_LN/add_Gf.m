%% Import data from text file
% Script for importing data from the following text file:
%
%    filename: C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Processing\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L0\2019\gri-19t.dat
%
% Auto-generated by MATLAB on 2022-11-25 11:23:39

%% Set up the Import Options and import the data
clear all
opts = delimitedTextImportOptions("NumVariables", 42);

% Specify range and delimiter
opts.DataLines = [1, Inf];
opts.Delimiter = " ";

% Specify column names and types
%opts.VariableNames = ["year", "day", "time", "pa", "t", "rh", "hitkassi", "BA", "doy", "HS", "snj2", "snj3", "q1", "q2", "sw_in", "f"];

opts.VariableNames = ["dagurbrot", "year", "day", "time", "x", "x2", "x3", "x4", "x5", "klsmm", "x6", "loftvgi", "hitiLogan", "hitmax", "timhitmax", "hitmin", "timhitmin", "x7", "x8", "loftrst", "urkomaMm", "x9", "x10", "x11", "hitihsgafl", "x12", "x13", "x14", "x15", "x16", "x17", "x18", "x19", "x20", "x21", "x22", "x23", "x55", "x44", "vindhrai", "slgeisl", "x33"];
opts.VariableTypes = ["double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";
opts.ConsecutiveDelimitersRule = "join";
opts.LeadingDelimitersRule = "ignore";

% Specify variable properties
opts = setvaropts(opts, "dagurbrot", "TrimNonNumeric", true);
opts = setvaropts(opts, "dagurbrot", "ThousandsSeparator", ",");

% Import the data
tdata = readtable("C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Processing\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L0\2019\gri-19t.dat", opts);

t = datetime(datenum([tdata.year],1,tdata.day+(tdata.time)/24),'ConvertFrom','datenum');
B = table2timetable(tdata,'RowTimes',t);
 B(end,:) = [];
B = removevars(B, ["dagurbrot","year","day","time","x","x2","x3","x4","x5","klsmm","x6","hitmax","timhitmax","hitmin","timhitmin","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18","x19","x20","x21","x22","x23","x55","x44","x33"]);

B.Properties.VariableNames(1) = "ps";
B.Properties.VariableNames(2) = "t";
B.Properties.VariableNames(3) = "ps2";
B.Properties.VariableNames(4) = "precip";
B.Properties.VariableNames(5) = "t2";
B.Properties.VariableNames(6) = "f";
B.Properties.VariableNames(7) = "sw_in";


uqy = unique(B.Time.Year);

sitename = ['ICE-GAWS_Gf_L1_',num2str(uqy),'.csv'];
fname = ['C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Processing\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L1\',sitename];
writetimetable(B,fname,'Delimiter',',');
clear opts
%%
opts = delimitedTextImportOptions("NumVariables", 42);

% Specify range and delimiter
opts.DataLines = [1, Inf];
opts.Delimiter = ",";

% Specify column names and types
opts.VariableNames = ["dagurbrot", "year", "day", "time", "x", "x2", "x3", "x4", "x5", "klsmm", "x6", "loftvgi", "hitiLogan", "hitmax", "timhitmax", "hitmin", "timhitmin", "x7", "x8", "loftrst", "urkomaMm", "x9", "x10", "x11", "hitihsgafl", "x12", "x13", "x14", "x15", "x16", "x17", "x18", "x19", "x20", "x21", "x22", "x23", "x55", "x44", "vindhrai", "slgeisl", "x33"];
opts.VariableTypes = ["double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double"];
%opts.VariableNames = ["VarName1", "VarName2", "VarName3", "VarName4", "VarName5", "VarName6", "VarName7", "VarName8", "VarName9", "VarName10", "VarName11", "VarName12", "VarName13", "VarName14", "VarName15", "VarName16", "VarName17", "VarName18", "VarName19", "VarName20", "VarName21", "VarName22", "VarName23", "VarName24", "VarName25", "VarName26", "VarName27", "VarName28", "VarName29", "VarName30", "VarName31", "VarName32", "VarName33", "VarName34", "VarName35", "VarName36", "VarName37", "VarName38", "VarName39", "VarName40", "VarName41", "VarName42"];
opts.VariableTypes = ["double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";
% Specify variable properties
opts = setvaropts(opts, ["dagurbrot", "year", "day", "time", "x", "x2", "x3", "x4", "x5", "klsmm", "x6", "loftvgi", "hitiLogan", "hitmax", "timhitmax", "hitmin", "timhitmin", "x7", "x8", "loftrst", "urkomaMm", "x9", "x10", "x11", "hitihsgafl", "x12", "x13", "x14", "x15", "x16", "x17", "x18", "x19", "x20", "x21", "x22", "x23", "x55", "x44", "vindhrai", "slgeisl", "x33"], "ThousandsSeparator", ",");

% Import the data
tdata = readtable("C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Processing\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L0\2020\gri-20t.dat", opts);
%
t = datetime(datenum([tdata.year],1,tdata.day+(tdata.time)/24),'ConvertFrom','datenum');
B = table2timetable(tdata,'RowTimes',t);
B(end,:) = [];
B = removevars(B, ["dagurbrot","year","day","time","x","x2","x3","x4","x5","klsmm","x6","hitmax","timhitmax","hitmin","timhitmin","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18","x19","x20","x21","x22","x23","x55","x44","x33"]);
B.Properties.VariableNames(1) = "ps";
B.Properties.VariableNames(2) = "t";
B.Properties.VariableNames(3) = "ps2";
B.Properties.VariableNames(4) = "precip";
B.Properties.VariableNames(5) = "t2";
B.Properties.VariableNames(6) = "f";
B.Properties.VariableNames(7) = "sw_in";

uqy = unique(B.Time.Year);

sitename = ['ICE-GAWS_Gf_L1_',num2str(uqy),'.csv'];
fname = ['C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Processing\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L1\',sitename];
writetimetable(B,fname,'Delimiter',',');
clear opts
%%
opts = delimitedTextImportOptions("NumVariables", 42);

% Specify range and delimiter
opts.DataLines = [1, Inf];
opts.Delimiter = " ";

% Specify column names and types
opts.VariableNames = ["dagurbrot", "year", "day", "time", "x", "x2", "x3", "x4", "x5", "klsmm", "x6", "loftvgi", "hitiLogan", "hitmax", "timhitmax", "hitmin", "timhitmin", "x7", "x8", "loftrst", "urkomaMm", "x9", "x10", "x11", "hitihsgafl", "x12", "x13", "x14", "x15", "x16", "x17", "x18", "x19", "x20", "x21", "x22", "x23", "x55", "x44", "vindhrai", "slgeisl", "x33"];
opts.VariableTypes = ["double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";
opts.ConsecutiveDelimitersRule = "join";
opts.LeadingDelimitersRule = "ignore";

% Specify variable properties
opts = setvaropts(opts, "dagurbrot", "TrimNonNumeric", true);
opts = setvaropts(opts, "dagurbrot", "ThousandsSeparator", ",");

% Import the data
tdata = readtable("C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Processing\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L0\2021\gri-21t.dat", opts);
%
t = datetime(datenum([tdata.year],1,tdata.day+(tdata.time)/24),'ConvertFrom','datenum');
B = table2timetable(tdata,'RowTimes',t);
B(end,:) = [];
B = removevars(B, ["dagurbrot","year","day","time","x","x2","x3","x4","x5","klsmm","x6","hitmax","timhitmax","hitmin","timhitmin","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18","x19","x20","x21","x22","x23","x55","x44","x33"]);
B.Properties.VariableNames(1) = "ps";
B.Properties.VariableNames(2) = "t";
B.Properties.VariableNames(3) = "ps2";
B.Properties.VariableNames(4) = "precip";
B.Properties.VariableNames(5) = "t2";
B.Properties.VariableNames(6) = "f";
B.Properties.VariableNames(7) = "sw_in";
uqy = unique(B.Time.Year);
%
sitename = ['ICE-GAWS_Gf_L1_',num2str(uqy),'.csv'];
fname = ['C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Processing\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L1\',sitename];
writetimetable(B,fname,'Delimiter',',');
clear opts
%% 2022
opts = delimitedTextImportOptions("NumVariables", 42);

% Specify range and delimiter
opts.DataLines = [1, Inf];
opts.Delimiter = " ";

% Specify column names and types
opts.VariableNames = ["dagurbrot", "year", "day", "time", "x", "x2", "x3", "x4", "x5", "klsmm", "x6", "loftvgi", "hitiLogan", "hitmax", "timhitmax", "hitmin", "timhitmin", "x7", "x8", "loftrst", "urkomaMm", "x9", "x10", "x11", "hitihsgafl", "x12", "x13", "x14", "x15", "x16", "x17", "x18", "x19", "x20", "x21", "x22", "x23", "x55", "x44", "vindhrai", "slgeisl", "x33"];
opts.VariableTypes = ["double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";
opts.ConsecutiveDelimitersRule = "join";
opts.LeadingDelimitersRule = "ignore";

% Specify variable properties
opts = setvaropts(opts, "dagurbrot", "TrimNonNumeric", true);
opts = setvaropts(opts, "dagurbrot", "ThousandsSeparator", ",");

% Import the data
tdata = readtable("C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Data\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L0\2022\gri-22t.dat", opts);
%
t = datetime(datenum([tdata.year],1,tdata.day+(tdata.time)/24),'ConvertFrom','datenum');
B = table2timetable(tdata,'RowTimes',t);
B(end,:) = [];
B = removevars(B, ["dagurbrot","year","day","time","x","x2","x3","x4","x5","klsmm","x6","hitmax","timhitmax","hitmin","timhitmin","x7","x8","x9","x10","x11","x12","x13","x14","x15","x16","x17","x18","x19","x20","x21","x22","x23","x55","x44","x33"]);
B.Properties.VariableNames(1) = "ps";
B.Properties.VariableNames(2) = "t";
B.Properties.VariableNames(3) = "ps2";
B.Properties.VariableNames(4) = "precip";
B.Properties.VariableNames(5) = "t2";
B.Properties.VariableNames(6) = "f";
B.Properties.VariableNames(7) = "sw_in";
uqy = unique(B.Time.Year);
%
sitename = ['ICE-GAWS_Gf_L1_',num2str(uqy),'.csv'];
fname = ['C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Data\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L1\',sitename];
writetimetable(B,fname,'Delimiter',',');
clear opts
%% 2023
datetime.setDefaultFormats('default','yyyy-MM-dd HH:mm:ss');

opts = delimitedTextImportOptions("NumVariables", 11);

% Specify range and delimiter
opts.DataLines = [1, Inf];
opts.Delimiter = ",";

% Specify column names and types
opts.VariableNames = ["timi", "year", "day", "hhmm", "t", "ps", "sw_in", "f", "ps2", "precip", "volt"];
opts.VariableTypes = ["double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";

% Specify variable properties
opts = setvaropts(opts, ["timi", "year", "day", "hhmm", "t", "ps", "sw_in", "f", "ps2", "precip", "volt"], "ThousandsSeparator", ",");

% Import the data
tdata = readtable("C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Data\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L0\2023\gri-23t.dat", opts);

%%
%t = datetime(datenum([tdata.year],1,tdata.day),'ConvertFrom','datenum');
t = datetime(tdata.timi + datenum('2022/12/31'),'convertFrom','datenum');

B = table2timetable(tdata,'RowTimes',t);
B(1,:) = [];
B = removevars(B, ["ps2","precip","volt","timi","year","day","hhmm"]);
B(end,:) = [];

uqy = unique(B.Time.Year);
%
sitename = ['ICE-GAWS_Gf_L1_',num2str(uqy),'.csv'];
fname = ['C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Data\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L1\',sitename];
writetimetable(B,fname,'Delimiter',',');
%% 2024
datetime.setDefaultFormats('default','yyyy-MM-dd HH:mm:ss');

opts = delimitedTextImportOptions("NumVariables", 11);

% Specify range and delimiter
opts.DataLines = [1, Inf];
opts.Delimiter = ",";

% Specify column names and types
                        %Ar,    dagn,  klst,   t,   t-min,   timi-tmin,   t-max,   timi-tmax,  P,    úrkoma,    Vh,Sw-in
opts.VariableNames = ["year", "day", "hhmm", "t", "t_min", "timi_tmin", "t_max", "timi_tmax", "ps", "precip", "vh", "sw_in"];
opts.VariableTypes = [ "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double", "double"];

% Specify file level properties
opts.ExtraColumnsRule = "ignore";
opts.EmptyLineRule = "read";

% Specify variable properties
opts = setvaropts(opts, ["year", "day", "hhmm", "t", "t_min", "timi_tmin", "t_max", "timi_tmax", "ps", "precip", "vh", "sw_in"], "ThousandsSeparator", ",");

% Import the data
tdata = readtable("C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Data\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L0\2024\Grims-2024-m-header.dat", opts);

%%
dt = datetime(tdata.year, 1, 1) + days(tdata.day - 1) + hours(tdata.hhmm);

% Optional: format for clarity
dt.Format = 'yyyy-MM-dd HH:mm';
%% Create datetime
dt = datetime(tdata.year, 1, 1) + days(tdata.day - 1) + hours(hh) + minutes(mm);
%%
B = table2timetable(tdata,'RowTimes',dt);
B(1,:) = [];
B = removevars(B, ["year","day","hhmm","t_min","timi_tmin","t_max","timi_tmax","precip","vh"]);
B(end,:) = [];

uqy = unique(B.Time.Year);
%%
sitename = ['ICE-GAWS_Gf_L1_',num2str(uqy),'.csv'];
fname = ['C:\Users\andrigun\Dropbox\01-Projects\ICE-GAWS-Data\data\vatnajokull\vatnajokull_Grimsfjall_Gf\L1\',sitename];
writetimetable(B,fname,'Delimiter',',');



